(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{810:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return Maps}));__webpack_require__(19),__webpack_require__(18),__webpack_require__(74),__webpack_require__(43),__webpack_require__(62),__webpack_require__(20),__webpack_require__(128),__webpack_require__(50),__webpack_require__(75),__webpack_require__(45),__webpack_require__(129),__webpack_require__(16);var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(12),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_12__),react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(3),react_dom__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(55),react_addons_css_transition_group__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(54),react_addons_css_transition_group__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(react_addons_css_transition_group__WEBPACK_IMPORTED_MODULE_15__),_dynamicLoaders_ComponentsFactory__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(15),_utils_events_EventsService__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(5),_actions_components_Actions__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(23),_utils_utils_Utils__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(2),_utils_utils_Consts__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(0),_dynamicLoaders_ServiceFactory__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(1),_common_GenericReactComponentWrapper__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(30);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_12___default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var Block=__webpack_require__(89).Block;class Maps extends _common_GenericReactComponentWrapper__WEBPACK_IMPORTED_MODULE_22__.a{constructor(props){super(props),this.defaultMode=props.config.defaultMode||"place",this.state={style:{},mode:this.defaultMode,params:{},shouldUpdateIframes:!1},this.supportedIframes={},this.currentParams={},this.currentParamsAll={};var modes=props.config.modes||{};this.modeConfig={},modes&&Object.keys(modes).forEach(mode=>{modes[mode].hide||(this.supportedIframes[mode]=!0,this.modeConfig[mode]=modes[mode])}),this.currentMode=this.defaultMode,this.allowedParams=_objectSpread({place:["q"],directions:["origin","destination"],search:["q"],view:["center","zoom"]},this.buildConfigObjectByKey("allowedParams")),this.fallbaclModeParam={place:{q:" "},directions:{origin:" ",destination:" "},search:{q:" "},view:{center:"0,0",q:" "}},this.defaultModeParams=_objectSpread({},this.fallbaclModeParam,{},this.buildConfigObjectByKey("defaultModeParams")),this.fallbaclModeParam=_objectSpread({},this.defaultModeParams,{},this.fallbaclModeParam),this.defaultParams=props.config.defaultParams||{},this.iframeSettings=this.buildConfigObjectByKey("iframeSettings"),this.iframeComps=this.buildConfigObjectByKey("iframe"),this.iframeParentStyle=this.buildConfigObjectByKey("iframeParentStyle"),this.geoData=_objectSpread({city:" ",country_name:" ",state:" ",latitude:0,longitude:0},props.config.defaultGeo||{}),this.pref=_dynamicLoaders_ServiceFactory__WEBPACK_IMPORTED_MODULE_21__.a.get(_utils_utils_Consts__WEBPACK_IMPORTED_MODULE_20__.Ib);var prefGeo=this.pref.get(_utils_utils_Consts__WEBPACK_IMPORTED_MODULE_20__.kb);this.geoData=_objectSpread({},this.geoData,{},Object(_utils_utils_Utils__WEBPACK_IMPORTED_MODULE_19__.r)(prefGeo)?prefGeo:{}),this.apiKey=props.config.apiKey||"AIzaSyD8-LmPff_7iYmE8syMYQJY-xZlF9a-oWY",this.baseSrc=props.config.baseSrc||"https://www.google.com/maps/embed/v1/{{mode}}?key={{apiKey}}{{params}}",this.updateIframeEvent=this.props.config.updateIframeEvent||"MAPS_WIDGET_IFRAME_UPDATE",this.iframes={},Object.keys(this.supportedIframes).forEach(key=>{var iframesBehaviours={behaviours:[{on:this.updateIframeEvent,do:"SET_CONFIG",c:{arg:"mode",val:key,op:"="}}]};this.iframes[key]=this.createIframe(this.buildIframeObject(key,null,iframesBehaviours),key)}),this.handleClick=this.handleClick.bind(this)}buildConfigObjectByKey(key){var obj={},self=this;return this.supportedIframes&&Object.keys(this.supportedIframes).forEach(mode=>{obj[mode]=self.modeConfig[mode][key]}),obj}buildIframeObject(mode,mapApiParamsObj,reactConfig){var src=this.buildMapSrc(mode,mapApiParamsObj);if(this.iframeComps[mode]){var config=this.iframeComps[mode],iframeSettings=_objectSpread({},config.iframeSettings,{src:src});return _objectSpread({},config,{iframeSettings:iframeSettings})}return _objectSpread({iframeSettings:_objectSpread({},this.iframeSettings[mode],{src:src})},reactConfig||{})}buildMapSrc(mode,paramsObj){var _mode=mode||this.defaultMode,src=this.baseSrc.replace("{{mode}}",_mode).replace("{{apiKey}}",this.apiKey),params="",combinedParams=_objectSpread({},this.defaultModeParams[_mode]||{},{},this.defaultParams,{},paramsObj||{});return(combinedParams=this.getParams(mode,combinedParams))&&Object.keys(combinedParams).forEach(key=>{params+=`&${key}=${combinedParams[key]}`}),src=src.replace("{{params}}",params),encodeURI(src)}createIframe(config,key){var ComponentObject=_dynamicLoaders_ComponentsFactory__WEBPACK_IMPORTED_MODULE_16__.a.createComponent("Iframe");return react__WEBPACK_IMPORTED_MODULE_13__.createElement(ComponentObject,{key:key,config:config,parentState:this.state[key],hover:this.state.hovered})}componentDidMount(){if(this.mounted=!0,this.props.config.attributes){var elem=react_dom__WEBPACK_IMPORTED_MODULE_14__.findDOMNode(this);if(elem){var self=this;this.props.config.attributes&&Object.keys(this.props.config.attributes).forEach(att=>{elem.setAttribute(att,self.props.config.attributes[att])})}}_actions_components_Actions__WEBPACK_IMPORTED_MODULE_18__.a.bind(this)(this.props.config.behaviours)}componentWillUnmount(){this.mounted=!1,_actions_components_Actions__WEBPACK_IMPORTED_MODULE_18__.b.bind(this)(this.props.config.behaviours)}buildModesButtons(){var response=null,container={type:"Container",style:this.props.config.modeButtonsContainerStyle||{},components:[]},self=this;return this.supportedIframes&&Object.keys(this.supportedIframes).forEach(mode=>{var button=self.modeConfig[mode].modeButton;button.style=mode===self.currentMode?button.selectedStyle:button.notSelectedStyle,container.components.push(button)}),container.components.length?(container={container:container},response=this.createChildrenComponents(container)):response}buildModesInputs(mode){var _mode=mode||this.currentMode,config=this.buildConfigObjectByKey("paramsBoxes");return Object(_utils_utils_Utils__WEBPACK_IMPORTED_MODULE_19__.r)(config)&&Object(_utils_utils_Utils__WEBPACK_IMPORTED_MODULE_19__.r)(config[_mode])?this.createChildrenComponents(config[_mode]):null}createChildrenComponents(components){var childrenComponents,self=this;return components&&(childrenComponents=Object.keys(components).map(componentKey=>{if(Object(_utils_utils_Utils__WEBPACK_IMPORTED_MODULE_19__.r)(components[componentKey])&&components[componentKey].type){var ComponentObject=_dynamicLoaders_ComponentsFactory__WEBPACK_IMPORTED_MODULE_16__.a.createComponent(components[componentKey].type);return react__WEBPACK_IMPORTED_MODULE_13__.createElement(ComponentObject,{key:componentKey,config:components[componentKey],hover:self.state.hovered})}return null})),childrenComponents}getCurrentIframe(){var divStyle={};this.iframes&&Object.keys(this.iframes).forEach(key=>{divStyle[key]={display:"none"}}),divStyle[this.currentMode]=_objectSpread({},this.iframeParentStyle[this.currentMode]);var that=this;return Object.keys(this.iframes).map(componentKey=>react__WEBPACK_IMPORTED_MODULE_13__.createElement("div",{key:componentKey,style:divStyle[componentKey]},that.iframes[componentKey]))}getParams(mode,params){var obj=this.getRelevantParams(mode,_objectSpread({},this.currentParams[mode],{},this.state.params,{},params));obj&&Object.keys(obj).forEach(key=>{obj[key]=obj[key]?obj[key].trim():obj[key]}),obj=this.fillMandatoryParams(mode,obj);var that=this,str=JSON.stringify(obj);return Object.keys(this.geoData).forEach(key=>{var rgx=new RegExp(`{{${key}}}`,"g");str=str.replace(rgx,that.geoData[key])}),obj=JSON.parse(str),this.currentParams[mode]=obj,Object.assign(this.currentParamsAll,obj),Object.assign(this.state.params,obj),obj}getRelevantParams(mode,params){var paramsObj=_objectSpread({},params);if(this.allowedParams[mode]){var self=this;params&&Object.keys(params).forEach(key=>{self.allowedParams[mode].includes(key)||delete paramsObj[key]})}return paramsObj}fillMandatoryParams(mode,params){if(!mode)return params;var obj=_objectSpread({},params||{}),self=this;return this.defaultModeParams[mode]&&Object.keys(this.defaultModeParams[mode]).forEach(param=>{obj[param]=obj[param]||self.fallbaclModeParam[mode][param]}),obj}updateIframes(forceParams){forceParams=forceParams||{};var self=this;this.iframes&&Object.keys(this.iframes).forEach(mode=>{var currentParams=self.currentParams[mode],newParams=self.getParams(mode,_objectSpread({},self.state.params,{},forceParams.params));Object(_utils_utils_Utils__WEBPACK_IMPORTED_MODULE_19__.a)(currentParams,newParams)||_utils_events_EventsService__WEBPACK_IMPORTED_MODULE_17__.a.trigger(self.updateIframeEvent,[{mode:mode,config:self.buildIframeObject(mode,newParams)}])})}componentWillUpdate(nextProps){}render(){var maps;return Object(_utils_utils_Utils__WEBPACK_IMPORTED_MODULE_19__.C)(this.props.config),this.currentMode=this.state.mode,maps=this.shouldHide()?null:react__WEBPACK_IMPORTED_MODULE_13__.createElement(Block,{onClick:this.handleClick,style:this.props.config.style},this.buildModesButtons(),this.buildModesInputs(),this.getCurrentIframe()),this.props.config.animateClass&&(maps=react__WEBPACK_IMPORTED_MODULE_13__.createElement(react_addons_css_transition_group__WEBPACK_IMPORTED_MODULE_15___default.a,{transitionName:this.props.config.animateClass,transitionAppear:!0,transitionAppearTimeout:0,transitionEnterTimeout:0,transitionLeaveTimeout:0},maps)),maps}handleClick(event){if(this.props.config.events&&this.props.config.events.onClick){event.stopPropagation();var params=_objectSpread({},this.props.config.events.onClick);_utils_events_EventsService__WEBPACK_IMPORTED_MODULE_17__.a.trigger(this.props.config.events.onClick.name,[params,_objectSpread({},this.props.config)])}this.props.onClick&&this.props.onClick(event)}}_dynamicLoaders_ComponentsFactory__WEBPACK_IMPORTED_MODULE_16__.a.add(()=>Maps,"Maps")}}]);